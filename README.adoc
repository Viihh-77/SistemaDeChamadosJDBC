# RELATÓRIO DE IMPLEMENTAÇÃO — SISTEMA DE CHAMADOS

Este documento descreve, de forma completa e organizada, o comportamento esperado de cada classe e de cada método para que todos os testes do Sistema de Chamados funcionem corretamente. Use-o como referência ao implementar os serviços.

---

## Visão geral
O projeto possui quatro serviços principais:
- `UsuarioService`: operações básicas de usuário.
- `ChamadoService`: abertura e consulta de chamados.
- `AtendimentoService`: controle de início e fim do atendimento.
- `RelatorioService`: consultas específicas e dados agregados.

Para cada método estão descritos: parâmetros, retorno e a lógica esperada (incluindo mensagens de exceção exatas).

---

## 1. UsuarioService
Serviço responsável pelas operações básicas de usuário.

### Métodos a implementar

#### 1. cadastrarUsuario(Usuario usuario)
- Parâmetros: `Usuario usuario`
- Retorno: `Usuario` (usuario cadastrado)
- Lógica:
  - Se `usuario` for nulo, lançar:
    - `RuntimeException("Usuário inválido!")`
  - Se o `nome` for nulo ou vazio, lançar:
    - `RuntimeException("Nome é obrigatório!")`
  - Se o `email` for nulo ou vazio, lançar:
    - `RuntimeException("Email é obrigatório!")`
  - Salvar o usuário no banco.
  - Retornar o usuário completo (conforme salvo no banco).

#### 2. buscarUsuarioPorId(long id)
- Parâmetros: `long id`
- Retorno: `Usuario`
- Lógica:
  - Buscar o usuário no banco.
  - Se não existir, lançar:
    - `RuntimeException("Usuário não encontrado!")`
  - Retornar o usuário.

---

## 2. ChamadoService
Serviço responsável pela abertura e consulta de chamados.

### Métodos a implementar

#### 1. abrirChamado(Chamado chamado)
- Parâmetros: `Chamado chamado`
- Retorno: `Chamado` (chamado aberto)
- Lógica:
  - Se `chamado` for nulo, lançar:
    - `RuntimeException("Chamado inválido!")`
  - Validar usuário:
    - Se `usuarioId` não existir no banco → `RuntimeException("Usuário não encontrado!")`
  - Se a `descricao` for nula ou vazia → `RuntimeException("Descrição é obrigatória!")`
  - Definir:
    - `status = "ABERTO"`
    - `dataAbertura = LocalDateTime.now()`
  - Salvar o chamado no banco.
  - Retornar o chamado salvo.

#### 2. buscarChamadoPorId(long id)
- Parâmetros: `long id`
- Retorno: `Chamado`
- Lógica:
  - Buscar no banco.
  - Se não existir → `RuntimeException("Chamado não encontrado!")`
  - Retornar o chamado.

---

## 3. AtendimentoService
Serviço que controla o início e fim do atendimento de um chamado.

### Métodos a implementar

#### 1. iniciarAtendimento(Atendimento atendimento)
- Parâmetros: `Atendimento atendimento`
- Retorno: `Atendimento` (atendimento iniciado)
- Lógica:
  - Se `atendimento` for nulo, lançar:
    - `RuntimeException("Atendimento inválido!")`
  - Validar existência do chamado associado:
    - Se não existe → `RuntimeException("Chamado não encontrado!")`
  - Verificar se o chamado está com `status = "ABERTO"`:
    - Caso contrário → `RuntimeException("Chamado não está aberto!")`
  - Preencher:
    - `dataInicio = LocalDateTime.now()`
  - Salvar o atendimento no banco.
  - Retornar o atendimento.

#### 2. finalizarAtendimento(long id, String solucao)
- Parâmetros: `long id`, `String solucao`
- Retorno: `Atendimento` (atendimento finalizado)
- Lógica:
  - Buscar atendimento por ID.
  - Se não existir → `RuntimeException("Atendimento não encontrado!")`
  - Preencher:
    - `solucao =` solução recebida
    - `dataFim = LocalDateTime.now()`
  - Atualizar registro no banco.
  - Retornar o atendimento finalizado.

---

## 4. RelatorioService
Serviço de consultas específicas e dados agregados.

### Métodos a implementar

#### 1. listarChamadosAbertosPorPrioridade(String prioridade)
- Parâmetros: `String prioridade`
- Retorno: `List<ChamadoResumoDTO>`
- Lógica:
  - Buscar no banco os chamados onde:
    - `status = "ABERTO"`
    - `prioridade = prioridade`
  - Retornar a lista (pode ser vazia, mas nunca `null`).

#### 2. gerarRelatorioUsuariosComMaisChamados(int minimo)
- Parâmetros: `int minimo`
- Retorno: `List<UsuarioContagemChamadosDTO>`
- Lógica:
  - Se `minimo <= 0` → `RuntimeException("Valor mínimo inválido!")`
  - Consultar no banco usuários com quantidade de chamados ≥ `minimo`.
  - Retornar lista (vazia ou com dados).

#### 3. buscarDetalhesChamado(long id)
- Parâmetros: `long id`
- Retorno: `Optional<ChamadoResumoDTO>`
- Lógica:
  - Se `id <= 0` → `RuntimeException("ID inválido!")`
  - Buscar o chamado com join no usuário.
  - Se não encontrar → `Optional.empty()`
  - Se encontrar → `Optional.of(dto)`

---

## Ordem ideal para implementar a atividade
Para evitar erros e facilitar o desenvolvimento, implemente na seguinte ordem:

1. Criar/implementar `UsuarioService`  
   (Obrigatório para o funcionamento do `ChamadoService`.)

2. Criar/implementar `ChamadoService`  
   (Necessário antes de iniciar atendimentos.)

3. Criar/implementar `AtendimentoService`  
   (Depende do `ChamadoService`.)

4. Criar/implementar `RelatorioService`  
   (Depende das tabelas de `Chamado` + `Usuario`.)

5. Rodar todos os testes e corrigir exceções caso necessário.

---

## Observações finais
- As mensagens de exceção devem ser exatamente as especificadas acima para que os testes unitários possam validar os comportamentos.
- Listas retornadas devem ser nunca `null` (retornar lista vazia quando aplicável).
- Use `LocalDateTime.now()` para preencher datas de abertura, início e término conforme indicado.
